محاضرة: القسم 11 الدرس 52
تحويل البيانات باستخدام Pandas
مقدمة
صباح الخير أيها الطلاب، في محاضرة اليوم سننتقل إلى موضوع حيوي في مجال علوم البيانات. في كثير من الأحيان، نحصل على بيانات خام غير منظمة في ملفات نصية بسيطة. هدفنا اليوم هو تحويل هذه البيانات إلى صيغة أكثر تنظيمًا وسهولة في الاستخدام، مثل ملف CSV، وذلك باستخدام مكتبة بايثون القوية pandas.

الجسم
دعونا نلقي نظرة على ملف البيانات المصدر، Points.txt.

كما ترون، إنه ملف بسيط جداً يحتوي على أسماء ودرجات مقابلة، ولكنه يفتقر إلى عناوين الأعمدة التي توضح ما تمثله البيانات. هذه مشكلة شائعة جداً. الآن، دعونا نرى كيف سيقوم الكود بتحويل هذه البيانات.

استيراد مكتبة pandas

import pandas

هذا السطر هو الخطوة الأولى. نقوم باستيراد مكتبة pandas بأكملها، والتي تحتوي على كل الأدوات التي نحتاجها للتلاعب بالبيانات.

قراءة الملف النصي

my_data = pandas.read_csv("Points.txt")

هنا تبدأ العملية. الدالة pandas.read_csv() مرنة جداً. على الرغم من اسمها، يمكنها قراءة البيانات من أنواع مختلفة من الملفات النصية المحددة بفواصل، مثل ملفنا .txt. تقوم بقراءة البيانات وتنظيمها تلقائياً في شيء يسمى DataFrame، والذي يمكنكم اعتباره جدولاً قوياً يشبه جداول البيانات في Excel.

تحديد أسماء الأعمدة

my_data.columns = ["Name", "Points", ]

بعد قراءة البيانات، لا يحتوي DataFrame على أسماء أعمدة مناسبة. يسمح لنا هذا السطر بتعيين أسماء جديدة للأعمدة، مما يجعل البيانات أكثر وضوحاً وفائدة. نحن نقول لـ pandas أن العمود الأول يجب أن يسمى "Name" والثاني "Points".

تصدير إلى ملف CSV جديد

my_data.to_csv("Points.csv", index=None)

هذه هي الخطوة النهائية. يتم استخدام الدالة .to_csv() لكتابة محتويات DataFrame إلى ملف جديد. نحن نحدد اسم الملف الذي نريده، "Points.csv". المعامل index=None مهم جداً؛ فهو يمنع pandas من إضافة عمود فهرس رقمي إلى ملف الإخراج، مما يضمن أن يكون ملف CSV نظيفاً ويحتوي فقط على البيانات التي نحتاجها.

الخلاصة
لقد نجحنا في أخذ ملف نصي بسيط وغير منظم، وفي بضعة أسطر فقط، قمنا بتحويله إلى ملف CSV نظيف ومنظم. هذا يوضح قوة وكفاءة مكتبة pandas في التعامل مع مهام البيانات الشائعة. العملية بأكملها، من القراءة إلى التنظيف إلى التصدير، مبسطة وسهلة الفهم.

الكود الكامل والمشروح موجود أدناه للرجوع إليه.

# هذا السكربت يستخدم مكتبة pandas لتحويل البيانات من ملف نصي بسيط إلى ملف CSV منظم.

# محتويات الملف النصي الأصلي 'Points.txt' هي كالتالي:
# Name, Points
# Osama, 100
# Ahmed, 120
# Sayed, 320
# Mahmoud, 40
# Ali, 90
# Sameh, 500
# Eman, 300
# Saleh, 300


# استيراد مكتبة pandas الضرورية لمعالجة وتحليل البيانات.
import pandas

# قراءة البيانات من الملف النصي "Points.txt" إلى DataFrame في pandas.
# الدالة read_csv() مرنة ويمكنها التعامل مع الملفات النصية المحددة بفواصل.
my_data = pandas.read_csv("Points.txt")

# تعيين أسماء أعمدة واضحة وذات مغزى للـ DataFrame.
# هذا يجعل البيانات أسهل في الفهم والعمل معها.
my_data.columns = ["Name", "Points", ]

# كتابة الـ DataFrame إلى ملف CSV جديد يسمى "Points.csv".
# الوسيط 'index=None' يمنع pandas من كتابة فهرس الـ DataFrame كعمود إضافي.
my_data.to_csv("Points.csv", index=None)
